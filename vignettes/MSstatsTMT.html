<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Ting Huang (thuang0703@gmail.com), Meena Choi (mnchoi67@gmail.com), Sicheng Hao (hao.sic@husky.neu.edu)" />

<meta name="date" content="2018-09-10" />

<title>MSstatsTMT : A package for protein significance analysis in shotgun mass spectrometry-based proteomic experiments with tandem mass tag (TMT) labeling</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">MSstatsTMT : A package for protein significance analysis in shotgun mass spectrometry-based proteomic experiments with tandem mass tag (TMT) labeling</h1>
<h4 class="author"><em>Ting Huang (<a href="mailto:thuang0703@gmail.com">thuang0703@gmail.com</a>), Meena Choi (<a href="mailto:mnchoi67@gmail.com">mnchoi67@gmail.com</a>), Sicheng Hao (<a href="mailto:hao.sic@husky.neu.edu">hao.sic@husky.neu.edu</a>)</em></h4>
<h4 class="date"><em>2018-09-10</em></h4>



<p>This vignette summarizes the introduction and various options of all functionalities in MSstatsTMT.</p>
<ul>
<li>A set of tools for detecting differentially abundant peptides and proteins in shotgun mass spectrometry-based proteomic experiments with tandem mass tag (TMT) labeling.</li>
<li>The types of experiment that MSstatsTMT supports for metabolic labeling or iTRAQ experiments. LC-MS, SRM, DIA(SWATH) with label-free or labeled synthetic peptides can be analyzed with other R package, MSstats.</li>
</ul>
<div id="pdtomsstatstmtformat" class="section level2">
<h2>PDtoMSstatsTMTFormat</h2>
<p>Preprocess PSM data from Proteome Discoverer and convert into the required input format for MSstatsTMT.</p>
<div id="arguments" class="section level3">
<h3>Arguments</h3>
<ul>
<li><code>input</code> : data name of Proteome discover PSM output. Read PSM sheet.</li>
<li><code>annotation</code> : data frame which contains column <code>Run</code>, <code>Channel</code>, <code>Condition</code>, <code>BioReplicate</code>, <code>lMixture</code>.</li>
<li><code>fraction</code> : indicates whether the data has fractions. If there are fractions, then overlapped peptide ions will be removed and then fractions are combined for each biological mixture.</li>
<li><code>useNumProteinsColumn</code> : TURE(default) remove shared peptides by information of # Proteins column in PSM sheet.</li>
<li><code>useUniquePeptide</code> : TRUE(default) removes peptides that are assigned for more than one proteins. We assume to use unique peptide for each protein.</li>
<li><code>summaryforMultipleRows</code> : max(default) or sum - when there are multiple measurements for certain feature and certain run, use highest or sum of multiple intensities.</li>
<li><code>removePSM_withMissingValue_withinRun</code> : TRUE(default) will remove PSM with any missing value within each Run.</li>
<li><code>removeProtein_with1Peptide</code> : TRUE(default) will remove the proteins which have only 1 peptide and charge.</li>
<li><code>which.proteinid</code> : Use ‘Protein.Accessions’(default) column for protein name. ‘Master.Protein.Accessions’ can be used instead.</li>
</ul>
</div>
<div id="example" class="section level3">
<h3>Example</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(raw.input)
<span class="co">#&gt;   Checked Confidence Identifying.Node PSM.Ambiguity</span>
<span class="co">#&gt; 1   FALSE       High      Mascot (F4)   Unambiguous</span>
<span class="co">#&gt; 2   FALSE       High      Mascot (N4)   Unambiguous</span>
<span class="co">#&gt; 3   FALSE       High      Mascot (G4)   Unambiguous</span>
<span class="co">#&gt; 4   FALSE       High      Mascot (A4)      Selected</span>
<span class="co">#&gt; 5   FALSE       High      Mascot (N4)   Unambiguous</span>
<span class="co">#&gt; 6   FALSE       High      Mascot (K4)   Unambiguous</span>
<span class="co">#&gt;         Annotated.Sequence                                 Modifications</span>
<span class="co">#&gt; 1          [K].lQPLDFk.[E]                N-Term(TMT6plex); K7(TMT6plex)</span>
<span class="co">#&gt; 2   [K].lNYkPEEEYPDLSk.[H] N-Term(TMT6plex); K4(TMT6plex); K14(TMT6plex)</span>
<span class="co">#&gt; 3       [K].lVNEVTEFAk.[T]               N-Term(TMT6plex); K10(TMT6plex)</span>
<span class="co">#&gt; 4 [K].eQLQDMGLVDLFSPEk.[S]               N-Term(TMT6plex); K16(TMT6plex)</span>
<span class="co">#&gt; 5   [K].lNYkPEEEYPDLSk.[H] N-Term(TMT6plex); K4(TMT6plex); K14(TMT6plex)</span>
<span class="co">#&gt; 6       [K].eLFDPIISDR.[H]                              N-Term(TMT6plex)</span>
<span class="co">#&gt;   Sigma.UPS UPS.Unique X..Protein.Groups X..Proteins</span>
<span class="co">#&gt; 1      TRUE       TRUE                 1           1</span>
<span class="co">#&gt; 2      TRUE       TRUE                 1           1</span>
<span class="co">#&gt; 3      TRUE       TRUE                 1           1</span>
<span class="co">#&gt; 4      TRUE       TRUE                 1           1</span>
<span class="co">#&gt; 5      TRUE       TRUE                 1           1</span>
<span class="co">#&gt; 6      TRUE       TRUE                 1           1</span>
<span class="co">#&gt;   Master.Protein.Accessions Protein.Accessions</span>
<span class="co">#&gt; 1                 P01008ups          P01008ups</span>
<span class="co">#&gt; 2                 P06732ups          P06732ups</span>
<span class="co">#&gt; 3                 P02768ups          P02768ups</span>
<span class="co">#&gt; 4                 P01008ups          P01008ups</span>
<span class="co">#&gt; 5                 P06732ups          P06732ups</span>
<span class="co">#&gt; 6                 P06732ups          P06732ups</span>
<span class="co">#&gt;                                          Protein.Descriptions</span>
<span class="co">#&gt; 1      Antithrombin-III (Chain 33-464) - Homo sapiens (Human)</span>
<span class="co">#&gt; 2 Creatine kinase M-type (Chain 1-381) - Homo sapiens (Human)</span>
<span class="co">#&gt; 3         Serum albumin (Chain 26-609) - Homo sapiens (Human)</span>
<span class="co">#&gt; 4      Antithrombin-III (Chain 33-464) - Homo sapiens (Human)</span>
<span class="co">#&gt; 5 Creatine kinase M-type (Chain 1-381) - Homo sapiens (Human)</span>
<span class="co">#&gt; 6 Creatine kinase M-type (Chain 1-381) - Homo sapiens (Human)</span>
<span class="co">#&gt;   X..Missed.Cleavages Charge DeltaScore DeltaCn Rank Search.Engine.Rank</span>
<span class="co">#&gt; 1                   0      2          1       0    1                  1</span>
<span class="co">#&gt; 2                   1      3          1       0    1                  1</span>
<span class="co">#&gt; 3                   0      3          1       0    1                  1</span>
<span class="co">#&gt; 4                   0      3          1       0    1                  1</span>
<span class="co">#&gt; 5                   1      3          1       0    1                  1</span>
<span class="co">#&gt; 6                   0      2          1       0    1                  1</span>
<span class="co">#&gt;   m.z..Da. MH...Da. DeltaM..ppm. Deltam.z..Da.</span>
<span class="co">#&gt; 1 659.9110 1318.815   0.94833301  0.0006253370</span>
<span class="co">#&gt; 2 804.7817 2412.330   1.62711731  0.0013083790</span>
<span class="co">#&gt; 3 536.6519 1607.941   0.08320968  0.0000445988</span>
<span class="co">#&gt; 4 769.7486 2307.231   0.25151981  0.0001934380</span>
<span class="co">#&gt; 5 804.7806 2412.327   0.26084356  0.0002097470</span>
<span class="co">#&gt; 6 717.3964 1433.785   1.17660656  0.0008435000</span>
<span class="co">#&gt;                        Activation.Type MS.Order Isolation.Interference....</span>
<span class="co">#&gt; 1 CID (Collision Induced Dissociation)      MS2                   6.766383</span>
<span class="co">#&gt; 2 CID (Collision Induced Dissociation)      MS2                   0.000000</span>
<span class="co">#&gt; 3 CID (Collision Induced Dissociation)      MS2                  68.606460</span>
<span class="co">#&gt; 4 CID (Collision Induced Dissociation)      MS2                  76.066820</span>
<span class="co">#&gt; 5 CID (Collision Induced Dissociation)      MS2                   0.000000</span>
<span class="co">#&gt; 6 CID (Collision Induced Dissociation)      MS2                  11.325790</span>
<span class="co">#&gt;   Average.Reporter.S.N Ion.Inject.Time..ms. RT..min. First.Scan</span>
<span class="co">#&gt; 1               159.00             6.601878 148.9752      73748</span>
<span class="co">#&gt; 2                46.89            15.734270 135.2369      68094</span>
<span class="co">#&gt; 3                40.19             7.173252 154.1151      77159</span>
<span class="co">#&gt; 4                31.19             9.751245 196.9999     101816</span>
<span class="co">#&gt; 5                64.88            28.425920 135.1362      68036</span>
<span class="co">#&gt; 6                53.38             6.262698 161.8391      81809</span>
<span class="co">#&gt;   Spectrum.File Ions.Matched Ions.Score Identity.Strict Identity.Relaxed</span>
<span class="co">#&gt; 1             8         6/58      25.05              13               13</span>
<span class="co">#&gt; 2            10       16/142      25.97              13               13</span>
<span class="co">#&gt; 3             2        10/92      23.49              13               13</span>
<span class="co">#&gt; 4             4       11/176      16.86              13               13</span>
<span class="co">#&gt; 5            10       17/142      39.10              13               13</span>
<span class="co">#&gt; 6            14         6/88      41.36              13               13</span>
<span class="co">#&gt;   Expectation.Value Percolator.q.Value Percolator.PEP</span>
<span class="co">#&gt; 1       0.062367246                 NA             NA</span>
<span class="co">#&gt; 2       0.050461083                 NA             NA</span>
<span class="co">#&gt; 3       0.089321615                 NA             NA</span>
<span class="co">#&gt; 4       0.411108606                 NA             NA</span>
<span class="co">#&gt; 5       0.002454463                 NA             NA</span>
<span class="co">#&gt; 6       0.001458668                 NA             NA</span>
<span class="co">#&gt;   Reporter.Quan.Result.ID Peptide.Quan.Usage Quan.Info      X126    X127_N</span>
<span class="co">#&gt; 1                   95406               Used    Unique 135.61323  37.19384</span>
<span class="co">#&gt; 2                   94212               Used    Unique  42.86409  71.93141</span>
<span class="co">#&gt; 3                   97211               Used    Unique  38.54172  44.57129</span>
<span class="co">#&gt; 4                  109920               Used    Unique  28.15933  30.06204</span>
<span class="co">#&gt; 5                   94186               Used    Unique  64.29539 102.20020</span>
<span class="co">#&gt; 6                   99858               Used    Unique  46.16454  55.41194</span>
<span class="co">#&gt;      X127_C    X128_N    X128_C    X129_N    X129_C    X130_N    X130_C</span>
<span class="co">#&gt; 1 189.10156 258.05122 139.01194 125.76453  53.81655 183.68503 256.72159</span>
<span class="co">#&gt; 2  32.59500  13.47320  52.06803  46.63131  85.45609  41.64079  12.25365</span>
<span class="co">#&gt; 3  10.33450  30.76057  62.89271  20.92750  38.13717  53.09552  49.84501</span>
<span class="co">#&gt; 4  48.67455  33.78615  11.54678  48.19111  33.15123  11.19205  27.94818</span>
<span class="co">#&gt; 5  50.94621  19.76218  77.59829  64.78414 106.70743  62.48222  15.93023</span>
<span class="co">#&gt; 6  19.80868  45.59221  84.74119  14.34746  40.83719  86.82802  62.53925</span>
<span class="co">#&gt;        X131</span>
<span class="co">#&gt; 1 148.56371</span>
<span class="co">#&gt; 2  49.33819</span>
<span class="co">#&gt; 3  36.56030</span>
<span class="co">#&gt; 4  25.65331</span>
<span class="co">#&gt; 5  54.86919</span>
<span class="co">#&gt; 6  56.06314</span>
<span class="kw">head</span>(annotation)
<span class="co">#&gt;   Run Channel Condition  Mixture BioReplicate</span>
<span class="co">#&gt; 1   1    X126      Norm Mixture1       1.X126</span>
<span class="co">#&gt; 2   1  X127_N     0.667 Mixture1     1.X127_N</span>
<span class="co">#&gt; 3   1  X127_C     0.125 Mixture1     1.X127_C</span>
<span class="co">#&gt; 4   1  X128_N       0.5 Mixture1     1.X128_N</span>
<span class="co">#&gt; 5   1  X128_C         1 Mixture1     1.X128_C</span>
<span class="co">#&gt; 6   1  X129_N     0.125 Mixture1     1.X129_N</span>
required.input &lt;-<span class="st"> </span><span class="kw">PDtoMSstatsTMTFormat</span>(<span class="dt">input =</span> raw.input, <span class="dt">annotation =</span> annotation, <span class="dt">which.proteinid =</span> <span class="st">&quot;Master.Protein.Accessions&quot;</span>)
<span class="co">#&gt; ** Shared PSMs (assigned in multiple proteins) are removed.</span>
<span class="co">#&gt; ** Multiple measurements in a feature and a run are summarized by summaryforMultipleRows.</span>
<span class="kw">head</span>(required.input)
<span class="co">#&gt;   ProteinName               PeptideSequence Charge</span>
<span class="co">#&gt; 1      P10809      [R].rGVMLAVDAVIAELkk.[Q]      4</span>
<span class="co">#&gt; 2      P10809          [R].tVIIEQSWGSPk.[V]      2</span>
<span class="co">#&gt; 3      P10809 [K].pLVIIAEDVDGEALSTLVLNr.[L]      3</span>
<span class="co">#&gt; 4      P10809          [K].eIGNIISDAMkk.[V]      3</span>
<span class="co">#&gt; 5      P10809   [K].dPGMGAMGGMGGGMGGGMF.[-]      2</span>
<span class="co">#&gt; 6      Q16836           [R].lLVPYLMEAIr.[L]      2</span>
<span class="co">#&gt;                               PSM Channel Condition BioReplicate Run</span>
<span class="co">#&gt; 1      [R].rGVMLAVDAVIAELkk.[Q]_4     126      Norm       1.X126   1</span>
<span class="co">#&gt; 2          [R].tVIIEQSWGSPk.[V]_2     126      Norm       1.X126   1</span>
<span class="co">#&gt; 3 [K].pLVIIAEDVDGEALSTLVLNr.[L]_3     126      Norm       1.X126   1</span>
<span class="co">#&gt; 4          [K].eIGNIISDAMkk.[V]_3     126      Norm       1.X126   1</span>
<span class="co">#&gt; 5   [K].dPGMGAMGGMGGGMGGGMF.[-]_2     126      Norm       1.X126   1</span>
<span class="co">#&gt; 6           [R].lLVPYLMEAIr.[L]_2     126      Norm       1.X126   1</span>
<span class="co">#&gt;    Mixture Intensity</span>
<span class="co">#&gt; 1 Mixture1  66.86457</span>
<span class="co">#&gt; 2 Mixture1  85.05717</span>
<span class="co">#&gt; 3 Mixture1  10.31910</span>
<span class="co">#&gt; 4 Mixture1  51.42820</span>
<span class="co">#&gt; 5 Mixture1  19.44270</span>
<span class="co">#&gt; 6 Mixture1  38.31532</span></code></pre></div>
</div>
</div>
<div id="protein.summarization" class="section level2">
<h2>protein.summarization</h2>
<p>Protein-level summarization from PSM level quantification should be performed before testing differentially abundant proteins. Then, normalization between MS runs using normalization channels will be implemented.</p>
<div id="arguments-1" class="section level3">
<h3>Arguments</h3>
<ul>
<li><code>data</code> : Name of the output of PDtoMSstatsTMTFormat function or PSM-level quantified data from other tools. It should have columns named <code>Protein</code>, <code>PSM</code>, <code>Mixture</code>, <code>Run</code>, <code>Channel</code>, <code>Condition</code>, <code>BioReplicate</code>, <code>Intensity</code>.</li>
<li><code>method</code> : Five different summarization methods to protein-level can be performed : <code>MedianPolish</code>(default), <code>Huber</code>, <code>LogSum</code>, <code>Median</code>, <code>Biweight</code>.</li>
<li><code>normalization</code> : Normalization between MS runs. TRUE(default) needs at least normalization channel in each MS run, annotated by ‘Norm’ in Group column. It will be performed after protein-level summarization. FALSE will not perform normalization step.</li>
</ul>
</div>
<div id="example-1" class="section level3">
<h3>Example</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(required.input)
<span class="co">#&gt;   ProteinName               PeptideSequence Charge</span>
<span class="co">#&gt; 1      P10809      [R].rGVMLAVDAVIAELkk.[Q]      4</span>
<span class="co">#&gt; 2      P10809          [R].tVIIEQSWGSPk.[V]      2</span>
<span class="co">#&gt; 3      P10809 [K].pLVIIAEDVDGEALSTLVLNr.[L]      3</span>
<span class="co">#&gt; 4      P10809          [K].eIGNIISDAMkk.[V]      3</span>
<span class="co">#&gt; 5      P10809   [K].dPGMGAMGGMGGGMGGGMF.[-]      2</span>
<span class="co">#&gt; 6      Q16836           [R].lLVPYLMEAIr.[L]      2</span>
<span class="co">#&gt;                               PSM Channel Condition BioReplicate Run</span>
<span class="co">#&gt; 1      [R].rGVMLAVDAVIAELkk.[Q]_4     126      Norm       1.X126   1</span>
<span class="co">#&gt; 2          [R].tVIIEQSWGSPk.[V]_2     126      Norm       1.X126   1</span>
<span class="co">#&gt; 3 [K].pLVIIAEDVDGEALSTLVLNr.[L]_3     126      Norm       1.X126   1</span>
<span class="co">#&gt; 4          [K].eIGNIISDAMkk.[V]_3     126      Norm       1.X126   1</span>
<span class="co">#&gt; 5   [K].dPGMGAMGGMGGGMGGGMF.[-]_2     126      Norm       1.X126   1</span>
<span class="co">#&gt; 6           [R].lLVPYLMEAIr.[L]_2     126      Norm       1.X126   1</span>
<span class="co">#&gt;    Mixture Intensity</span>
<span class="co">#&gt; 1 Mixture1  66.86457</span>
<span class="co">#&gt; 2 Mixture1  85.05717</span>
<span class="co">#&gt; 3 Mixture1  10.31910</span>
<span class="co">#&gt; 4 Mixture1  51.42820</span>
<span class="co">#&gt; 5 Mixture1  19.44270</span>
<span class="co">#&gt; 6 Mixture1  38.31532</span>
<span class="kw">str</span>(required.input)
<span class="co">#&gt; 'data.frame':    14952 obs. of  10 variables:</span>
<span class="co">#&gt;  $ ProteinName    : Factor w/ 6016 levels &quot;&quot;,&quot;A0A0B4J2A2&quot;,..: 1028 1028 1028 1028 1028 3047 1028 1028 864 3047 ...</span>
<span class="co">#&gt;  $ PeptideSequence: Factor w/ 45359 levels &quot;[-].aYRPSETLcGGELVDTLQFVcGDR.[G]&quot;,..: 39866 42620 17555 5487 3766 36628 33408 11276 24228 8685 ...</span>
<span class="co">#&gt;  $ Charge         : int  4 2 3 3 2 2 3 3 2 2 ...</span>
<span class="co">#&gt;  $ PSM            : Factor w/ 209 levels &quot;[K].aAISQLr.[S]_2&quot;,..: 193 205 105 37 23 186 178 64 135 49 ...</span>
<span class="co">#&gt;  $ Channel        : Factor w/ 10 levels &quot;126&quot;,&quot;127_C&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="co">#&gt;  $ Condition      : Factor w/ 5 levels &quot;0.125&quot;,&quot;0.5&quot;,..: 5 5 5 5 5 5 5 5 5 5 ...</span>
<span class="co">#&gt;  $ BioReplicate   : Factor w/ 150 levels &quot;1.X126&quot;,&quot;1.X127_C&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="co">#&gt;  $ Run            : num  1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="co">#&gt;  $ Mixture        : Factor w/ 5 levels &quot;Mixture1&quot;,&quot;Mixture2&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="co">#&gt;  $ Intensity      : num  66.9 85.1 10.3 51.4 19.4 ...</span>
quant.byprotein &lt;-<span class="st"> </span><span class="kw">protein.summarization</span>(required.input,
                                         <span class="dt">method=</span><span class="st">&quot;MedianPolish&quot;</span>,
                                         <span class="dt">normalization=</span><span class="ot">TRUE</span>)
<span class="co">#&gt; ** Negative log2 intensities were replaced with zero.</span>
<span class="co">#&gt; Warning: attributes are not identical across measure variables;</span>
<span class="co">#&gt; they will be dropped</span>
<span class="co">#&gt; Joining, by = c(&quot;ProteinName&quot;, &quot;Run&quot;, &quot;Channel&quot;)</span>
<span class="co">#&gt; Warning: Column `Channel` joining factor and character vector, coercing</span>
<span class="co">#&gt; into character vector</span>
<span class="co">#&gt; Joining, by = c(&quot;Run&quot;, &quot;ProteinName&quot;)</span>
<span class="co">#&gt; Joining, by = c(&quot;ProteinName&quot;, &quot;PSM&quot;, &quot;Run&quot;, &quot;Channel&quot;)</span>
<span class="co">#&gt; Normalization between MS runs for Protein : O95747 ( 1  of  10 )</span>
<span class="co">#&gt; Normalization between MS runs for Protein : P01008ups ( 2  of  10 )</span>
<span class="co">#&gt; Normalization between MS runs for Protein : P02753ups ( 3  of  10 )</span>
<span class="co">#&gt; Normalization between MS runs for Protein : P02768ups ( 4  of  10 )</span>
<span class="co">#&gt; Normalization between MS runs for Protein : P02788ups ( 5  of  10 )</span>
<span class="co">#&gt; Normalization between MS runs for Protein : P06732ups ( 6  of  10 )</span>
<span class="co">#&gt; Normalization between MS runs for Protein : P10809 ( 7  of  10 )</span>
<span class="co">#&gt; Normalization between MS runs for Protein : P46734 ( 8  of  10 )</span>
<span class="co">#&gt; Normalization between MS runs for Protein : P53004 ( 9  of  10 )</span>
<span class="co">#&gt; Normalization between MS runs for Protein : Q16836 ( 10  of  10 )</span>
<span class="kw">head</span>(quant.byprotein)
<span class="co">#&gt;    Run Protein Abundance Channel BioReplicate Condition  Mixture</span>
<span class="co">#&gt; 1:   1  O95747  4.296628     126       1.X126      Norm Mixture1</span>
<span class="co">#&gt; 2:   1  O95747  4.415994   127_C     1.X127_C     0.125 Mixture1</span>
<span class="co">#&gt; 3:   1  O95747  4.346901   127_N     1.X127_N     0.667 Mixture1</span>
<span class="co">#&gt; 4:   1  O95747  4.323811   128_C     1.X128_C         1 Mixture1</span>
<span class="co">#&gt; 5:   1  O95747  4.534739   128_N     1.X128_N       0.5 Mixture1</span>
<span class="co">#&gt; 6:   1  O95747  4.476423   129_C     1.X129_C       0.5 Mixture1</span></code></pre></div>
</div>
</div>
<div id="groupcomparison.tmt" class="section level2">
<h2>groupComparison.TMT</h2>
<p>Tests for significant changes in protein abundance across conditions based on a family of linear mixed-effects models in TMT experiment. Experimental design of case-control study (patients are not repeatedly measured) or time course study (patients are repeatedly measured) is automatically determined based on proper statistical model.</p>
<div id="arguments-2" class="section level3">
<h3>Arguments</h3>
<ul>
<li><code>data</code> : Name of the output of protein.summarization function. It should have columns named <code>Protein</code>, <code>Mixture</code>, <code>Run</code>, <code>Channel</code>, <code>Condition</code>, <code>BioReplicate</code>, <code>Abundance</code>.</li>
<li><code>contrast.matrix</code> : Comparison between conditions of interests. 1) default is <code>pairwise</code>, which compare all possible pairs between two conditions. 2) Otherwise, users can specify the comparisons of interest. Based on the levels of conditions, specify 1 or -1 to the conditions of interests and 0 otherwise. The levels of conditions are sorted alphabetically.</li>
<li><code>remove_norm_channel</code> : TRUE(default) removes <code>Norm</code> channels for inference step.</li>
<li><code>moderated</code> : Only for model = <code>proposed</code>. If moderated = TRUE, then moderated t statistic will be calculated; otherwise, ordinary t statistic will be used.</li>
<li><code>adj.method</code> : adjusted method for multiple comparison. ’BH` is default.</li>
</ul>
</div>
<div id="example-2" class="section level3">
<h3>Example</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">quant.byprotein &lt;-<span class="st"> </span><span class="kw">protein.summarization</span>(required.input,
                                         <span class="dt">method =</span> <span class="st">&quot;MedianPolish&quot;</span>,
                                         <span class="dt">normalization=</span><span class="ot">TRUE</span>)
<span class="co">#&gt; ** Negative log2 intensities were replaced with zero.</span>
<span class="co">#&gt; Warning: attributes are not identical across measure variables;</span>
<span class="co">#&gt; they will be dropped</span>
<span class="co">#&gt; Joining, by = c(&quot;ProteinName&quot;, &quot;Run&quot;, &quot;Channel&quot;)</span>
<span class="co">#&gt; Warning: Column `Channel` joining factor and character vector, coercing</span>
<span class="co">#&gt; into character vector</span>
<span class="co">#&gt; Joining, by = c(&quot;Run&quot;, &quot;ProteinName&quot;)</span>
<span class="co">#&gt; Joining, by = c(&quot;ProteinName&quot;, &quot;PSM&quot;, &quot;Run&quot;, &quot;Channel&quot;)</span>
<span class="co">#&gt; Normalization between MS runs for Protein : O95747 ( 1  of  10 )</span>
<span class="co">#&gt; Normalization between MS runs for Protein : P01008ups ( 2  of  10 )</span>
<span class="co">#&gt; Normalization between MS runs for Protein : P02753ups ( 3  of  10 )</span>
<span class="co">#&gt; Normalization between MS runs for Protein : P02768ups ( 4  of  10 )</span>
<span class="co">#&gt; Normalization between MS runs for Protein : P02788ups ( 5  of  10 )</span>
<span class="co">#&gt; Normalization between MS runs for Protein : P06732ups ( 6  of  10 )</span>
<span class="co">#&gt; Normalization between MS runs for Protein : P10809 ( 7  of  10 )</span>
<span class="co">#&gt; Normalization between MS runs for Protein : P46734 ( 8  of  10 )</span>
<span class="co">#&gt; Normalization between MS runs for Protein : P53004 ( 9  of  10 )</span>
<span class="co">#&gt; Normalization between MS runs for Protein : Q16836 ( 10  of  10 )</span>

<span class="co"># Do all the pairwise comparison</span>
test.byproposed &lt;-<span class="st"> </span><span class="kw">groupComparison.TMT</span>(quant.byprotein)
<span class="co">#&gt; Testing for Protein : O95747 ( 1  of  10 )</span>
<span class="co">#&gt; Testing for Protein : P01008ups ( 2  of  10 )</span>
<span class="co">#&gt; Testing for Protein : P02753ups ( 3  of  10 )</span>
<span class="co">#&gt; Testing for Protein : P02768ups ( 4  of  10 )</span>
<span class="co">#&gt; Testing for Protein : P02788ups ( 5  of  10 )</span>
<span class="co">#&gt; Testing for Protein : P06732ups ( 6  of  10 )</span>
<span class="co">#&gt; Testing for Protein : P10809 ( 7  of  10 )</span>
<span class="co">#&gt; Testing for Protein : P46734 ( 8  of  10 )</span>
<span class="co">#&gt; Testing for Protein : P53004 ( 9  of  10 )</span>
<span class="co">#&gt; Testing for Protein : Q16836 ( 10  of  10 )</span>

<span class="co"># Only compare condition 0.125 and 1 </span>
<span class="kw">levels</span>(quant.byprotein<span class="op">$</span>Condition)
<span class="co">#&gt; [1] &quot;0.125&quot; &quot;0.5&quot;   &quot;0.667&quot; &quot;1&quot;     &quot;Norm&quot;</span>
<span class="co"># 'Norm' should be not considered in the contrast</span>
comparison&lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">nrow=</span><span class="dv">1</span>)
<span class="co"># Set the names of each row</span>
<span class="kw">row.names</span>(comparison)&lt;-<span class="st">&quot;1-0.125&quot;</span>
<span class="co"># Set the column names</span>
<span class="kw">colnames</span>(comparison)&lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;0.125&quot;</span>, <span class="st">&quot;0.5&quot;</span>, <span class="st">&quot;0.667&quot;</span>, <span class="st">&quot;1&quot;</span>)
test.contrast &lt;-<span class="st"> </span><span class="kw">groupComparison.TMT</span>(<span class="dt">data =</span> quant.byprotein, <span class="dt">contrast.matrix =</span> comparison)
<span class="co">#&gt; Testing for Protein : O95747 ( 1  of  10 )</span>
<span class="co">#&gt; Testing for Protein : P01008ups ( 2  of  10 )</span>
<span class="co">#&gt; Testing for Protein : P02753ups ( 3  of  10 )</span>
<span class="co">#&gt; Testing for Protein : P02768ups ( 4  of  10 )</span>
<span class="co">#&gt; Testing for Protein : P02788ups ( 5  of  10 )</span>
<span class="co">#&gt; Testing for Protein : P06732ups ( 6  of  10 )</span>
<span class="co">#&gt; Testing for Protein : P10809 ( 7  of  10 )</span>
<span class="co">#&gt; Testing for Protein : P46734 ( 8  of  10 )</span>
<span class="co">#&gt; Testing for Protein : P53004 ( 9  of  10 )</span>
<span class="co">#&gt; Testing for Protein : Q16836 ( 10  of  10 )</span>

<span class="co"># Compare 0.125 and 1, 0.5 and 0.667</span>
comparison&lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>, <span class="dv">0</span>,<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>),<span class="dt">nrow=</span><span class="dv">2</span>)
<span class="co"># Set the names of each row</span>
<span class="kw">row.names</span>(comparison)&lt;-<span class="kw">c</span>(<span class="st">&quot;1-0.125&quot;</span>, <span class="st">&quot;0.667-0.5&quot;</span>)
<span class="co"># Set the column names</span>
<span class="kw">colnames</span>(comparison)&lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;0.125&quot;</span>, <span class="st">&quot;0.5&quot;</span>, <span class="st">&quot;0.667&quot;</span>, <span class="st">&quot;1&quot;</span>)
test.contrast &lt;-<span class="st"> </span><span class="kw">groupComparison.TMT</span>(<span class="dt">data =</span> quant.byprotein, <span class="dt">contrast.matrix =</span> comparison)
<span class="co">#&gt; Testing for Protein : O95747 ( 1  of  10 )</span>
<span class="co">#&gt; Testing for Protein : P01008ups ( 2  of  10 )</span>
<span class="co">#&gt; Testing for Protein : P02753ups ( 3  of  10 )</span>
<span class="co">#&gt; Testing for Protein : P02768ups ( 4  of  10 )</span>
<span class="co">#&gt; Testing for Protein : P02788ups ( 5  of  10 )</span>
<span class="co">#&gt; Testing for Protein : P06732ups ( 6  of  10 )</span>
<span class="co">#&gt; Testing for Protein : P10809 ( 7  of  10 )</span>
<span class="co">#&gt; Testing for Protein : P46734 ( 8  of  10 )</span>
<span class="co">#&gt; Testing for Protein : P53004 ( 9  of  10 )</span>
<span class="co">#&gt; Testing for Protein : Q16836 ( 10  of  10 )</span></code></pre></div>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
